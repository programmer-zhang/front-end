# 区块链安全(十): 7702 钓鱼

> 本文使用Grok辅助编写

## 阅读本文您将收获
* EIP-7702介绍
* 防范EIP-7702钓鱼

## EIP-7702 协议介绍

### 什么是EIP-7702？
EIP-7702 是 `Ethereum` 网络的一项重要升级提案，于2024年提出，并在 `Pectra` 硬分叉中实施。它引入了一种新的交易类型（类型码0x04），允许外部拥有的账户（Externally Owned Accounts, EOA）在单个交易中临时设置授权，从而让EOA临时具备智能合约账户的功能，而无需永久迁移账户类型。 这是一种账户抽象（Account Abstraction）的实现方式，旨在桥接传统EOA和智能合约账户之间的差距。

### EIP-7702 能做什么？
EIP-7702 的主要功能是允许EOA在交易执行期间“借用”智能合约代码，实现更复杂的操作。例如：

- **批量交易**：用户可以一次性执行多个操作，如批准代币、转移资产等，而无需多次签名。
- **Gas赞助**：第三方（如DApp）可以为用户支付Gas费用，降低用户门槛。
- **高级认证**：支持多因素认证、密钥恢复等功能，提升安全性。
- **灵活升级**：EOA可以临时指向一个智能合约实现地址，执行自定义逻辑。

### EIP-7702 怎么用？
使用 EIP-7702 时，用户在构建交易时需要包含一个“授权列表”（`authorization list`），其中指定了临时合约代码、`nonce` 等信息。过程如下：

1. 用户生成一个包含EIP-7702授权的交易（类型0x04）。

![](../images/blockchain/phish-7702_example-arb.png)

2. 交易中包括`contract_code`字段，指向要执行的代码或地址。
3. 用户签名交易后，提交到网络。
4. 在交易执行阶段，EOA临时转换为智能合约账户，执行授权的操作，然后恢复原状。

### EIP-7702解决了什么问题？

EIP-7702旨在解决 `Ethereum` 账户系统的痛点：

- **兼容性问题**：传统EOA无法执行复杂逻辑，需要迁移到智能合约账户，但迁移过程复杂且有风险。EIP-7702允许渐进式采用账户抽象，无需永久变更。

- **用户体验差**：多步操作（如approve + transfer）需要多次签名，EIP-7702支持批处理，减少交互。

- **Gas效率低**：支持Gas赞助和优化，降低成本。

- **安全性提升**：通过临时授权，避免永久暴露账户，但也引入新风险（详见下文）。 总体上，它使Ethereum更用户友好，推动 Web3 大规模采用。

## EIP-7702钓鱼是怎么回事

### EIP-7702钓鱼的原理
* 本质上是利用 EIP-7702 的授权机制诱导用户签名恶意交易。 
* 攻击者通过假冒DApp、社交工程或恶意网站，让用户签名一个包含恶意授权的交易。
	* 该授权允许攻击者临时控制用户的EOA，执行转移资产等操作，而用户往往不知情。 
	* 与传统钓鱼不同，EIP-7702钓鱼不需要窃取私钥，只需诱导一次签名即可实现资产盗取。这使得攻击更隐蔽，因为交易看起来像是正常的授权请求。

**典型攻击流程：**

1. 用户访问假网站（如伪造的空投页面或钱包更新界面）。
2. 网站要求用户签名EIP-7702交易，声称是“升级账户”或“领取奖励”。
3. 签名后，授权激活，攻击者立即执行恶意代码转移资产。
4. 交易完成后，账户恢复，但资产已丢失。

### 一个 EIP-7702 钓鱼交易例子
以下是一个具体的EIP-7702钓鱼交易例子，交易哈希为：`0xa2b0ca83a3533e4e25f97d6d0bf181266c144be6980206818e27e07bbc44fff5`

这是一笔典型的 `EIP-7702` 钓鱼交易。 发送者（受害者）是一个普通EOA地址，在交易中包含了EIP-7702授权列表，指向一个恶意合约地址。该合约代码被设计为执行批量转移操作，包括将受害者的代币（如ETH或ERC-20）发送到攻击者控制的地址。

详细解释：

- **交易类型**：EIP-7702授权交易（0x04类型），包含临时授权。
- **发送者**：受害者EOA地址，签名了交易。
- **接收者**：一个看似无害的合约，但实际是钓鱼合约。
- **输入数据**：解码后显示为`setAuthorization`调用，授权恶意代码执行转移函数（如`transferFrom`或`executeBatch`）。
- **结果**：授权激活后，攻击者立即转移了受害者的资产，导致资金丢失。无价值直接转移，但通过授权间接实现。 此交易突显了EIP-7702的便利性如何被滥用：受害者可能以为是批准一个简单操作，却不知授权了全面控制。

要避免此类钓鱼，应仔细检查签名请求，确保网站合法，并使用支持风险模拟的钱包（如MetaMask）。

## EIP-7702钓鱼高发链、高发场景及著名事件

### 高发链
EIP-7702 钓鱼主要发生在 `Ethereum` 主网及其兼容链上，因为EIP-7702是 `Ethereum` 的核心升级。 高发链包括：

- **Ethereum主网**：最常见，2025年报告显示占钓鱼损失的80%以上。
- **EVM兼容链**：如 `Polygon`、`Binance Smart Chain（BSC）` 。 这些链因交易量大、用户基数广而成为目标。
- **Layer 2网络**：如 `Optimism` 和 `Arbitrum`，如果它们采用类似抽象机制，也易受影响。

跨链重放攻击也是风险点，攻击者在多链上重复利用同一授权。

### 高发场景

EIP-7702钓鱼常见于以下场景：

- **假DApp交互**：伪造的DeFi平台（如Uniswap假网站）要求签名“批量批准”。
- **空投或私人销售**：诱导用户签名领取“奖励”或参与WLFI等私人放置。
- **钱包更新或升级**：假冒钱包界面提示“激活EIP-7702功能”。
- **社交工程**：通过Discord、Telegram或X传播恶意链接。
- **AI辅助诈骗**：2025年AI生成个性化钓鱼页面，增加成功率。

这些场景利用用户对新功能的信任，签名率高达90%在初次接触时。

### 从EIP-7702诞生以来发生的著名事件

EIP-7702于2024年提出，2025年 `Pectra` 升级后迅速被利用。以下是自2024年以来的一些著名事件（基于2025年报告）：

- **2025年5月：Top 7702 Delegator钓鱼事件**：一个假“委托”网站诱导用户授权，导致多个钱包丢失总计数十万美元。攻击者伪装成合法委托服务。
- **2025年6月：$146K Memecoin盗窃案**：EIP-7702推出几周内，一用户在假DApp签名授权，丢失$146K memecoins。
- **2025年8月：$1M Uniswap钓鱼事件**：投资者在伪造Uniswap页面签名EIP-7702交易，丢失$1M资产。
- **2025年8月：月度总损失$12M**：Ethereum上EIP-7702相关钓鱼激增，单月损失$12M，影响数百用户。
- **2025年8月：MetaMask WLFI私人销售钓鱼**：用户参与假WLFI销售，签名后MetaMask资产全失。